<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Markerless WebAR Video</title>
    <!-- Include A-Frame and Zappar -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://libs.zappar.com/zappar-aframe/1.3.0/zappar-aframe.js"></script>
    <style>
        /* Add a "Tap to Start" button */
        #startButton {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            z-index: 9999;
        }
    </style>
</head>
<body>
    <!-- Tap to start button -->
    <button id="startButton">TAP TO START AR</button>

    <!-- AR Scene -->
    <a-scene zappar-camera background="color: #ECECEC">
        <!-- Instant World Tracking (place video on floors/walls) -->
        <a-entity 
            id="video-container"
            zappar-instant="placement-mode: floor" 
            visible="false"
        >
            <!-- Video element (using a public test video) -->
            <a-video
                src="#sample-video"
                width="2"
                height="1.125"
                position="0 0.5 0"
                rotation="-90 0 0"
            ></a-video>
        </a-entity>

        <!-- Sample video (public test URL) -->
        <video 
            id="sample-video" 
            loop 
            crossorigin="anonymous"
            playsinline
            webkit-playsinline
        >
            <!-- Replace with your video URL -->
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4" type="video/mp4">
        </video>
    </a-scene>

    <script>
        // Handle button click to start AR
        const startButton = document.getElementById('startButton');
        const scene = document.querySelector('a-scene');
        const videoContainer = document.querySelector('#video-container');
        const videoElement = document.querySelector('#sample-video');

        startButton.addEventListener('click', async () => {
            // Request camera permissions
            try {
                await scene.zapparCamera.start();
                startButton.style.display = 'none';
                videoContainer.setAttribute('visible', 'true');
            } catch (error) {
                alert("Camera access denied. Please enable permissions.");
            }

            // Play video on first user interaction
            videoElement.play();
        });
    </script>
</body>
</html>